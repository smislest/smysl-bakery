# üöÄ Git Deployment Guide

–í–∞—à –ø—Ä–æ–µ–∫—Ç —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Git –¥–ª—è –¥–µ–ø–ª–æ—è!

## üìã –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (–æ–¥–∏–Ω —Ä–∞–∑)

### –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
ssh root@79.174.82.76

# –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
cd /opt

# –ë—ç–∫–∞–ø —Å—Ç–∞—Ä–æ–π –≤–µ—Ä—Å–∏–∏ (–µ—Å–ª–∏ –Ω—É–∂–µ–Ω)
mv smysl-bakery smysl-bakery-backup

# –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/smislest/smysl-bakery.git
cd smysl-bakery

# –°–æ–∑–¥–∞–π—Ç–µ .env.local —Ñ–∞–π–ª
nano .env.local
```

–í—Å—Ç–∞–≤—å—Ç–µ –≤ `.env.local`:
```env
NEXT_PUBLIC_DIRECTUS_URL="https://admin.smislest.ru"
NEXT_PUBLIC_DIRECTUS_TOKEN="Ysoj__Fjk6I8vddYHp_ZH7EbGxcf4pG8"
```

–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ (Ctrl+O, Enter, Ctrl+X)

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
npm install

# –°–æ–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç
npm run build

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —á–µ—Ä–µ–∑ PM2
pm2 delete smysl-bakery 2>/dev/null || true
pm2 start npm --name "smysl-bakery" -- start
pm2 save
pm2 startup
```

---

## üîÑ –ï–∂–µ–¥–Ω–µ–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ö–æ–≥–¥–∞ –º–µ–Ω—è–µ—Ç–µ –¥–∏–∑–∞–π–Ω/–≤—ë—Ä—Å—Ç–∫—É –ª–æ–∫–∞–ª—å–Ω–æ:

**–í–∞—Ä–∏–∞–Ω—Ç 1: PowerShell —Å–∫—Ä–∏–ø—Ç (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è Windows)**
```powershell
.\deploy-git.ps1
```

**–í–∞—Ä–∏–∞–Ω—Ç 2: Git Bash/Linux**
```bash
./deploy-git.sh
```

**–í–∞—Ä–∏–∞–Ω—Ç 3: –í—Ä—É—á–Ω—É—é**
```bash
# 1. –ó–∞–∫–æ–º–º–∏—Ç—å—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
git add .
git commit -m "–û–±–Ω–æ–≤–∏–ª –¥–∏–∑–∞–π–Ω –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã"
git push origin main

# 2. –î–µ–ø–ª–æ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä
ssh root@79.174.82.76 "cd /opt/smysl-bakery && git pull && npm install --production && npm run build && pm2 restart smysl-bakery"
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–µ–ø–ª–æ—è

```
–õ–æ–∫–∞–ª—å–Ω–æ (E:\site-smyslest\site\smysl-bakery)
    ‚Üì
    git push
    ‚Üì
GitHub (https://github.com/smislest/smysl-bakery)
    ‚Üì
    git pull
    ‚Üì
–°–µ—Ä–≤–µ—Ä (/opt/smysl-bakery)
```

---

## ‚ö° –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –¥–µ–ø–ª–æ–µ

1. **–ö–æ–º–º–∏—Ç** ‚Üí –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤–∞—à–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ Git
2. **Push** ‚Üí –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ GitHub
3. **Pull** ‚Üí –°–µ—Ä–≤–µ—Ä —Å–∫–∞—á–∏–≤–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å GitHub
4. **Install** ‚Üí –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –Ω–æ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å)
5. **Build** ‚Üí –°–æ–±–∏—Ä–∞–µ—Ç production –≤–µ—Ä—Å–∏—é
6. **Restart** ‚Üí –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ PM2

---

## üõ†Ô∏è –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
```bash
ssh root@79.174.82.76 "pm2 status"
```

### –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
```bash
ssh root@79.174.82.76 "pm2 logs smysl-bakery --lines 50"
```

### –û—Ç–∫–∞—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è (–µ—Å–ª–∏ —á—Ç–æ-—Ç–æ —Å–ª–æ–º–∞–ª–æ—Å—å)
```bash
# –õ–æ–∫–∞–ª—å–Ω–æ
git log --oneline  # –Ω–∞–π–¥–∏—Ç–µ –∫–æ–º–º–∏—Ç –¥–ª—è –æ—Ç–∫–∞—Ç–∞
git reset --hard COMMIT_HASH
git push --force origin main

# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
ssh root@79.174.82.76 "cd /opt/smysl-bakery && git pull --force && npm run build && pm2 restart smysl-bakery"
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞–∫–∞—è –≤–µ—Ä—Å–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
```bash
ssh root@79.174.82.76 "cd /opt/smysl-bakery && git log -1 --oneline"
```

---

## ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Git –¥–µ–ø–ª–æ—è

- ‚ú® **–ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π** - –º–æ–∂–Ω–æ –æ—Ç–∫–∞—Ç–∏—Ç—å –ª—é–±—É—é –≤–µ—Ä—Å–∏—é
- üöÄ **–ë—ã—Å—Ç—Ä–æ** - –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
- üîí **–ë–µ–∑–æ–ø–∞—Å–Ω–æ** - –≤–µ—Å—å –∫–æ–¥ –≤ GitHub
- üë• **–ö–æ–º–∞–Ω–¥–Ω–∞—è —Ä–∞–±–æ—Ç–∞** - –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
- üìä **–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ** - –∫—Ç–æ, —á—Ç–æ –∏ –∫–æ–≥–¥–∞ –º–µ–Ω—è–ª

---

## üéØ –ì–æ—Ç–æ–≤–æ!

–¢–µ–ø–µ—Ä—å –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∏–∑–∞–π–Ω–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ:
```powershell
.\deploy-git.ps1
```

–í–≤–µ–¥–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π, –∏ –≤—Å—ë –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!
